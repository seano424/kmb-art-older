"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("picosanity")),r=e(require("@sanity/image-url")),n=require("react"),o=require("use-deep-compare-effect"),i=e(require("groq"));function a(){return"undefined"==typeof AbortController?{signal:void 0,abort:u}:new AbortController}function u(){}function c(e,t){return fetch("https://"+e+".api.sanity.io/v1/users/me",{credentials:"include",signal:null==t?void 0:t.signal}).then(e=>e.json()).then(e=>(null==e?void 0:e.id)?e:null).catch(e=>"AbortError"===e.name?null:Promise.reject(e))}exports.groq=i,exports.createClient=function(e){return t(e)},exports.createCurrentUserHook=function(e){let t=e.projectId;return()=>function(e){const t=n.useState(),r=t[0],o=t[1],i=n.useState(),u=i[0],s=i[1];return n.useEffect(()=>{const t=a();return c(e,t).then(o).catch(s),()=>t.abort()},[e]),{data:r,error:u,loading:null!==r||!u}}(t)},exports.createImageUrlBuilder=function(e){return r({projectId:e.projectId,dataset:e.dataset})},exports.createPreviewSubscriptionHook=function(e){let t,r=e.projectId,i=e.dataset,u=e.documentLimit,s=void 0===u?3e3:u;return function(e,t){void 0===t&&(t={});const i=t.params;return function(e){const t=e.getStore,r=e.projectId,i=e.query,u=e.params,s=e.initialData,l=e.enabled,d=void 0!==l&&l,f=n.useState(),p=f[0],b=f[1],h=n.useState(!1),v=h[0],g=h[1],m=n.useState(s),y=m[0],j=m[1];return o.useDeepCompareEffectNoCheck(()=>{if(!d)return()=>{};g(!0);const e=a();let n;return c(r,e).then(e=>{if(!e)throw console.warn("Not authenticated - preview not available"),new Error("Not authenticated - preview not available")}).then(t).then(e=>{n=e.subscribe(i,u,(e,t)=>{e?b(e):j(t)})}).catch(b).finally(()=>g(!1)),()=>{n&&n.unsubscribe(),e.abort()}},[t,i,u,d]),{data:y,loading:v,error:p}}({getStore:l,projectId:r,query:e,params:void 0===i?{}:i,initialData:t.initialData,enabled:!!t.enabled&&"undefined"!=typeof window})};function l(){return t||(t=new Promise((function(e){e(function(e){if(e&&e.__esModule)return e;var t={};return e&&Object.keys(e).forEach((function(r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})})),t.default=e,t}(require("@sanity/groq-store")))})).then(e=>(0,e.groqStore)({projectId:r,dataset:i,documentLimit:s,listen:!0,overlayDrafts:!0,subscriptionThrottleMs:10}))),t}};
//# sourceMappingURL=next-sanity.cjs.production.min.js.map
